import{_ as s,c as a,o as i,a4 as n}from"./chunks/framework.CmqN_Wm4.js";const u=JSON.parse('{"title":"部署ChatGPT代理","description":"","frontmatter":{"title":"部署ChatGPT代理","tags":["ChatGPT","代理"],"date":"2024/08/09 21:56:45"},"headers":[],"relativePath":"posts/2024/gptProx.md","filePath":"blog/posts/2024/gptProx.md","lastUpdated":1723885829000}'),t={name:"posts/2024/gptProx.md"},p=n(`<h1 id="部署chatgpt代理" tabindex="-1">部署ChatGPT代理 <a class="header-anchor" href="#部署chatgpt代理" aria-label="Permalink to &quot;部署ChatGPT代理&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">引言</p><p>在国内使用ChatGPT经常遇到不稳定的情况，或者是和别人共用plus账户容易因为IP不同而导致封号等等；本文提供一种服务器代理方案，可以完美的解决以上问题。</p></div><h2 id="_1-准备一台云服务器-国内国外都可" tabindex="-1">1.准备一台云服务器（国内国外都可） <a class="header-anchor" href="#_1-准备一台云服务器-国内国外都可" aria-label="Permalink to &quot;1.准备一台云服务器（国内国外都可）&quot;">​</a></h2><h2 id="_2-部署chat2api" tabindex="-1">2.部署chat2api <a class="header-anchor" href="#_2-部署chat2api" aria-label="Permalink to &quot;2.部署chat2api&quot;">​</a></h2><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/LanQian528/chat2api</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chat2api</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 因为原项目的requirements少了个包</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> APScheduler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &gt;&gt;&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">requirements.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> requirements.txt</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置代理（国外服务器不需要设置代理）</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HTTP_PROXY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:7890&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> HTTPS_PROXY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://localhost:7890&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 进程挂起</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uvicorn</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chat2api:app</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0.0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5005</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uvicorn.log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;&amp;1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 本地启动用这个</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># python app.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>关于chat2api的更多信息可移步<a href="https://github.com/lanqian528/chat2api/" target="_blank" rel="noreferrer">https://github.com/lanqian528/chat2api/</a></p><p>到这里，如果是国内服务器的话，还不能访问，还需设置代理</p></div><h2 id="_3-安装clash-国外的服务器可以省略这步" tabindex="-1">3.安装clash（国外的服务器可以省略这步） <a class="header-anchor" href="#_3-安装clash-国外的服务器可以省略这步" aria-label="Permalink to &quot;3.安装clash（国外的服务器可以省略这步）&quot;">​</a></h2><p>下载项目</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>git clone https://github.com/wanhebin/clash-for-linux.git</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>进入到项目目录，编辑.env文件，修改变量CLASH_URL的值。</p><p><code>CLASH_URL</code> 就是clash的订阅码，如果Clash订阅地址不可访问，请切换通用订阅码</p><p><img src="https://cdn.jsdelivr.net/gh/caiwuu/image/202408092317218.png" alt="image-20240809222956102"></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cd clash-for-linux</span></span>
<span class="line"><span>vim .env</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>之后访问http://xxxx:9090设置节点（不要使用香港的节点）</p><p><img src="https://cdn.jsdelivr.net/gh/caiwuu/image/202408092320366.png" alt="image-20240809232030313"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>关于clash-for-linux的更多信息可移步<a href="https://github.com/wnlen/clash-for-linux" target="_blank" rel="noreferrer">https://github.com/wnlen/clash-for-linux</a></p></div><p>最后就可以成功访问了</p><p><img src="https://cdn.jsdelivr.net/gh/caiwuu/image/202408092324490.png" alt="image-20240809232447335"></p><h2 id="_4-关于稳定性" tabindex="-1">4.关于稳定性 <a class="header-anchor" href="#_4-关于稳定性" aria-label="Permalink to &quot;4.关于稳定性&quot;">​</a></h2><p>如果你只是用免费的gpt-4o-mini,推荐使用<code>/backend-anon/conversations/</code>接口，本人实测这个很稳定,但是原项目没有写这个接口的代理，需要改下代码，在chat2api.py文件中加一行代码：</p><p><img src="https://cdn.jsdelivr.net/gh/caiwuu/image/202408171709939.png" alt="image-20240817170904816"></p>`,21),e=[p];function l(h,r,c,k,d,o){return i(),a("div",null,e)}const b=s(t,[["render",l]]);export{u as __pageData,b as default};
